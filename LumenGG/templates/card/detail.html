{% extends "base.html" %}
{% load static %}
{% load card_tags %}
{% block title %}
{{ card.name }}
{% endblock title %}
{% block style %}
<link rel="stylesheet" href="{% static "card/detail.css" %}">
{% endblock style %}
{% block content %}
<div>
    <div>
        <a id="돌아가기" href="javascript:history.back()">← 돌아가기</a>
    </div>
    <div id="섹션1">
        <div id="카드" class="배경색1">
            <img class="w-100" src="{{ card.img }}" alt="{{ card.img }}">
            <div class="카드정보">
                <p class="캐릭터명">{{ card.character.name }}</p>
                <p class="카드명">{{ card.name }}</p>
            </div>
        </div>
        <div>
            {% if card.type == "공격" %}
            <div id="기본정보" class="공격">
                <div id="판정" class="정보상자">
                    <div><p>판정</p></div><div><p>{{ card.pos }} {{ card.body|default_if_none:"" }}</p></div>
                </div>
                <div id="특수" class="정보상자">
                    <div><p>특수 판정</p></div><div><p>{{ card.special|default_if_none:"X" }}</p></div>
                </div>
                <div id="댐지" class="정보상자">
                    <div><p>대미지</p></div><div><p>{{ card.damage }}</p></div>
                </div>
                <div id="속도" class="정보상자">
                    <div><p>속도</p></div><div><p>{{ card.frame }}</p></div>
                </div>
                <div id="처리">
                    <div id="처리1" class="정보상자">
                        <div><p>히트</p></div><div><p>{{ card.hit|default_if_none:"X" }}</p></div>
                    </div>
                    <div id="처리2" class="정보상자">
                        <div><p>가드</p></div><div><p>{{ card.guard|default_if_none:"X" }}</p></div>
                    </div>
                    <div id="처리3" class="정보상자">
                        <div><p>카운터</p></div><div><p>{{ card.counter|default_if_none:"X" }}</p></div>
                    </div>
                </div>
            </div>
            <hr class="my-4">
            {% elif card.type == "수비" %}
            <div id="기본정보" class="수비">
                <div id="처리">
                    <div id="처리1" class="정보상자">
                        <div><p>상단</p></div><div><p>{{ card.g_top|default_if_none:"X" }}</p></div>
                    </div>
                    <div id="처리2" class="정보상자">
                        <div><p>중단</p></div><div><p>{{ card.g_mid|default_if_none:"X" }}</p></div>
                    </div>
                    <div id="처리3" class="정보상자">
                        <div><p>하단</p></div><div><p>{{ card.g_bot|default_if_none:"X" }}</p></div>
                    </div>
                </div>
            </div>
            <hr class="my-4">
            {% endif %}
            <div id="섹션2">
                <div id="효과" class="배경색1">
                    <p>효과</p>
                    <p>{{ card.text|linebreaks }}</p>
                </div>
                <div class="배경색1">
                    <p>최초 수록</p>
                    <p>{{ card.code }}</p>
                </div>
                <div class="배경색1">
                    <p>태그</p>
                    <p>{{ card.keyword|keywords }}</p>
                </div>
            </div>
        </div>
    </div>
    <hr class="my-4">
    <div id="관련카드목록">
        <div class="d-flex flex-row mb-2">
            <select class="btn btn-sm border" name="kw" id="kwSelect">
                {% for kw in relation.keys %}
                <option value="{{ kw|cut:" " }}">{{kw}}</option>
                {% endfor %}
            </select>
            <p class="ms-2">관련 카드</p>
        </div>
        <div>
            {% for kw, vs in relation.items %}
            
            <div id="{{ kw|cut:" " }}" class="관련상자">
                {% for v in vs %}
                <div class="관련카드 배경색1">
                    <a href="{% url 'card:detail' v.id %}">
                        <div class="w-100 d-flex flex-column justify-content-center hoverBig">
                            <img class="w-100" src="{{ v.img }}" alt="{{ v.name }}">
                            <div class="카드정보">
                                <p class="캐릭터명2">{{ v.character.name }}</p>
                                <p class="카드명2">{{ v.name }}</p>
                            </div>
                        </div>
                    </a>
                </div>
                {% endfor %}
            </div>
            {% endfor %}
        </div>
    </div>
    <hr class="my-4">
    <div id="qna" class="mt-2 mb-3">
        <div class="w-100" style="font-size: 1.5em; font-weight: 900;">관련 Q&A</div>
        {% for qna in card.qna.all %}
        <a href="{% url "qna:detail" qna.id %}">
            <div class="질문답변 배경색1">
                <h4 class="mb-0">{{ qna.title }}</h4>
                <p class="mb-0"><b>Q: </b>{{ qna.question }}</p>
                <p class="mb-0"><b>A: </b>{{ qna.answer }}</p>
            </div>
        </a>
        {% endfor %}
    </div>
</div>
<script src="{% static "card/detail.js" %}"></script>
{% endblock content %}